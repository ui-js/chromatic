{{#if group}} <h3>{{ group }}</h3> {{/if}}

<div class='color-ramps'>
    {{#each colorRamps}}
    <div class="color-ramp">
        <h3>{{name}}</h3>
        
        <!-- Lightness Curve Visualization -->
        <div class="visualization-container">
            <h4>Lightness Curve (OKLCh)</h4>
            <svg class="lightness-chart" width="320" height="180" viewBox="0 0 320 180">
                <!-- Grid lines -->
                <g class="grid">
                    <line x1="10" y1="30" x2="10" y2="150" stroke="#e0e0e0" stroke-width="1"/>
                    <line x1="10" y1="150" x2="310" y2="150" stroke="#e0e0e0" stroke-width="1"/>
                    <line x1="10" y1="90" x2="310" y2="90" stroke="#f5f5f5" stroke-width="1"/>
                </g>
                <!-- Axis labels -->
                <text x="5" y="25" font-size="10" fill="#666">1.0</text>
                <text x="5" y="95" font-size="10" fill="#666">0.5</text>
                <text x="5" y="155" font-size="10" fill="#666">0.0</text>
                <text x="15" y="170" font-size="10" fill="#666">50</text>
                <text x="310" y="170" font-size="10" fill="#666">900</text>
                <text x="160" y="175" font-size="10" fill="#666" text-anchor="middle">Scale Index</text>
                <text x="2" y="90" font-size="10" fill="#666" text-anchor="middle" transform="rotate(-90, 2, 90)">Lightness</text>
                
                <!-- Lightness curve -->
                <polyline points="{{lightnessCurve}}" fill="none" stroke="#333" stroke-width="2" transform="translate(10, 0)"/>
                
                <!-- Data points -->
                {{#each lightnessData}}
                <circle cx="{{x}}" cy="{{y}}" r="4" fill="{{color}}" stroke="#333" stroke-width="1" transform="translate(10, 0)">
                    <title>{{index}}: L={{lightness}}</title>
                </circle>
                {{/each}}
            </svg>
        </div>
        
        <!-- Hue/Chroma Chart -->
        <div class="visualization-container">
            <h4>Hue/Chroma Distribution (OKLCh)</h4>
            <svg class="hue-chroma-chart" width="220" height="220" viewBox="0 0 220 220">
                <!-- Chroma circles -->
                <g class="chroma-circles">
                    <circle cx="110" cy="110" r="30" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                    <circle cx="110" cy="110" r="60" fill="none" stroke="#e0e0e0" stroke-width="1"/>
                    <circle cx="110" cy="110" r="90" fill="none" stroke="#d0d0d0" stroke-width="1"/>
                    <!-- Chroma scale info -->
                    {{#if hueChromaData.[0].maxChroma}}
                    <text x="5" y="25" font-size="8" fill="#999">Max C: {{hueChromaData.[0].maxChroma}}</text>
                    {{/if}}
                </g>
                <!-- Hue lines -->
                <g class="hue-lines">
                    <line x1="110" y1="20" x2="110" y2="200" stroke="#f5f5f5" stroke-width="1"/>
                    <line x1="20" y1="110" x2="200" y2="110" stroke="#f5f5f5" stroke-width="1"/>
                </g>
                <!-- Axis labels -->
                <text x="115" y="15" font-size="10" fill="#666">0°</text>
                <text x="205" y="115" font-size="10" fill="#666">90°</text>
                <text x="110" y="210" font-size="10" fill="#666" text-anchor="middle">180°</text>
                <text x="10" y="115" font-size="10" fill="#666">270°</text>
                <text x="110" y="235" font-size="10" fill="#666" text-anchor="middle">Hue</text>
                <text x="5" y="110" font-size="10" fill="#666" text-anchor="middle" transform="rotate(-90, 5, 110)">Chroma</text>
                
                <!-- Color points -->
                {{#each hueChromaData}}
                <circle cx="{{x}}" cy="{{y}}" r="6" fill="{{color}}" stroke="#333" stroke-width="1">
                    <title>{{index}}: H={{hue}}° C={{chroma}} L={{lightness}}</title>
                </circle>
                {{/each}}
            </svg>
        </div>
        
        <div class="checkerboard-bg">
            {{#each values}}
            <div class="color-ramp__item {{cls}}" style='background-color:{{css}}'>
                <h3 {{#if opaqueColor}}style='background:{{opaqueColor}}' {{/if}}>{{name}}</h3>
                {{#if deltaE }}<span class='warning-sign'>&#x26A0;</span>{{/if}}
                <h4 {{#if opaqueColor}}style='background:{{opaqueColor}}' {{/if}}>{{css}}</h4>
                {{#if deltaE }}<span class='deltaE'>&delta;E {{deltaE}}</span>{{/if}}
            </div>
            {{/each}}
        </div>
        <p class="value-source">{{source}}</p>
    </div>
    {{/each}}
</div>

<div class='color-chips'>
    {{#each colors}}
    <div class="color-chip">
        <div class='color-chip__swatch-container checkerboard-bg'>
            <div class='color-chip__swatch {{cls}}' style='background-color:{{css}}'>
                <h3 {{#if opaqueColor}}style='background:{{opaqueColor}}' {{/if}}>{{name}}</h3>
                <h4 {{#if opaqueColor}}style='background:{{opaqueColor}}' {{/if}}>{{css}}</h4>
            </div>
        </div>
        {{#if source}}
        <p class='value-source'>{{source}}</p>
        {{/if}}
        {{#if comment}}
        <p class='color-chip__comment'>{{{comment}}}</p>
        {{/if}}
        {{!-- <ul class='color-chip__similar-colors'>
            <li><span class='small-color-chip'>
                    <span style='background:{{protanopiaCss}}' class='small-color-chip__color'></span>
                </span>
            </li>
            <li><span class='small-color-chip'>
                    <span style='background:{{deuteranopiaCss}}' class='small-color-chip__color'></span>
                </span>
            </li>
            <li><span class='small-color-chip'>
                    <span style='background:{{tritanopiaCss}}' class='small-color-chip__color'></span>
                </span>
            </li>
        </ul> --}}
        {{#if similarColors}}
        <div class='color-chip__similar-colors'>
            {{#if similarColors.normal }}
            <h4>Similar Colors</h4>
            <ul>
                {{#each similarColors.normal }}
                <li><span class='small-color-chip'>
                        <span style='background:{{css}}' class='small-color-chip__color'></span>
                        <span class='small-color-chip__label'>{{name}}</span>
                    </span>
                    <span class='deltaE'>&delta;E {{deltaE}}</span>
                </li>
                {{/each}}
            </ul>
            {{/if}}
            {{!-- {{#if similarColors.protanopia }}
            <h4>Similar Colors for People with Protanopia</h4>
            <ul>
                {{#each similarColors.protanopia }}
                <li><span class='small-color-chip'>
                        <span style='background:{{css}}' class='small-color-chip__color'></span>
                        <span class='small-color-chip__label'>{{name}}</span>
                    </span>
                    <span class='deltaE'>&delta;E {{deltaE}}</span>
                </li>
                {{/each}}
            </ul>
            {{/if}}
            {{#if similarColors.deuteranopia }}
            <h4>Similar Colors for People with Deuteranopia</h4>
            <ul>
                {{#each similarColors.deuteranopia }}
                <li><span class='small-color-chip'>
                        <span style='background:{{css}}' class='small-color-chip__color'></span>
                        <span class='small-color-chip__label'>{{name}}</span>
                    </span>
                    <span class='deltaE'>&delta;E {{deltaE}}</span>
                </li>
                {{/each}}
            </ul>
            {{/if}}
            {{#if similarColors.tritanopia }}
            <h4>Similar Colors for People with Tritanopia</h4>
            <ul>
                {{#each similarColors.tritanopia }}
                <li><span class='small-color-chip'>
                        <span style='background:{{css}}' class='small-color-chip__color'></span>
                        <span class='small-color-chip__label'>{{name}}</span>
                    </span>
                    <span class='deltaE'>&delta;E {{deltaE}}</span>
                </li>
                {{/each}}
            </ul>
            {{/if}} --}}
            {{#if similarColors.colorDeficient }}
            <h4>Similar Colors for People with Color Deficiency</h4>
            <ul>
                {{#each similarColors.colorDeficient }}
                <li><span class='small-color-chip'>
                        <span style='background:{{css}}' class='small-color-chip__color'></span>
                        <span class='small-color-chip__label'>{{name}}</span>
                    </span>
                </li>
                {{/each}}
            </ul>
            {{/if}}
        </div>
        {{/if}}
    </div>
    {{/each}}
</div>